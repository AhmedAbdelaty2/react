---
id: raf-batching
title: requestAnimationFrame() Batching
layout: docs
permalink: raf-batching.html
prev: update.html
---

Since `renderComponent()` and `setState()` are asynchronous, React can coalesce multiple updates into a single render pass through the hierarchy. This can improve performance since you can call effectively call `setState()` as many times as you want for free.

By default we batch and coalesce all updates in event handlers and run all other updates synchronously. This makes testing a little easier, but if you want the highest performance possible you can enable batching for every animation frame using `ReactRAFBatchingStrategy`.

## Usage

Call `React.addons.injectRAFBatchingStrategy()` before rendering your component to enable this feature.

## A warning

If you have any code in your application that assumes that `setState()` is synchronous outside of event handlers it may break. Test cases usually fall into this category. For tests, either avoid this optimization or wait for the next frame after calling `setState()` before running any assertions.

## The future of this add-on

We plan on making a few tweaks to the React core API to make the asynchronity of `setState()` easier to understand. Once these are in place we plan to bake this add-on into core and enable it by default.
